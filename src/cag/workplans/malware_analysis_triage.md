# Malware Analysis Triage Workplan

This workplan outlines initial steps for analyzing a binary for potential malicious behavior using the available Ghidra tools.

## Goal: Perform initial static analysis to identify malware indicators.

### Phase 1: Gather Basic Information & Identify Obvious Red Flags

1.  **List Imported Functions (Focus on Suspicious APIs)**:
    ```
    EXECUTE: list_imports(offset=0, limit=200) 
    ```
    *   **Analysis Guidance**: Review the output against the "Suspicious Imports" section in the `knowledge_base.md`. Note any commonly abused Windows APIs related to process injection, networking, cryptography, persistence, or anti-analysis.

2.  **List Exported Functions (If Applicable, e.g., for DLLs)**:
    ```
    EXECUTE: list_exports(offset=0, limit=100)
    ```
    *   **Analysis Guidance**: Check for unusual or cryptically named exports. Do they suggest backdoor functionality?

3.  **List All Functions (Get an Overview)**:
    ```
    EXECUTE: list_functions()
    ```
    *   **Analysis Guidance**: Skim function names. Do any names suggest suspicious activities (e.g., `encrypt_data`, `send_network_packet`, `check_debugger`)? These might be candidates for targeted decompilation later.

### Phase 2: Initial Code Review for String & Function Clues

4.  **Identify and Decompile Functions Likely to Handle Strings or Perform Key Operations**:
    *   **Guidance**: Based on the import list (e.g., functions calling network APIs, file APIs, or crypto APIs) and suspicious function names from `list_functions`, select a few high-priority functions for decompilation.
    *   Example (replace with actual name or address):
        ```
        EXECUTE: decompile_function(name="might_be_c2_handler") 
        ```
        or
        ```
        EXECUTE: decompile_function_by_address(address="14000XXXX")
        ```
    *   **Analysis Guidance**: Manually analyze the decompiled code of these selected functions. Look for embedded strings (IPs, URLs, commands, registry keys), calls to other suspicious internal functions, or logic patterns indicative of malware (see `knowledge_base.md` for string and function analysis tips).

5.  **Perform Contextual Analysis on Suspicious Functions**:
    *   **Guidance**: For the most suspicious functions identified (especially potential command handlers, network functionality, or injection routines), use the analyze_function tool to get a comprehensive view of the function and all functions it calls.
    *   Example:
        ```
        EXECUTE: analyze_function(address="14000XXXX")
        ```
    *   **Analysis Guidance**: This provides both the function itself and all functions it calls in a single view, allowing for better understanding of the code's behavior and data flow. Pay special attention to:
        - How data is passed between functions
        - What each called function contributes to the overall functionality
        - Potential obfuscation techniques where functionality is split across multiple functions

### Phase 3: Summarize Initial Findings

6.  **Synthesize Information**:
    *   **Guidance**: Based on the analysis of imports, exports (if any), function names, and the content of a few decompiled functions, provide a preliminary assessment. Are there strong indicators of malicious behavior? What are the key suspicious areas identified so far that warrant further investigation?

### Common Next Steps (Beyond this Triage Workplan):
*   Detailed decompilation and analysis of more functions.
*   Manual cross-referencing to understand how suspicious functions are used.
*   Renaming functions and variables based on understood behavior. 